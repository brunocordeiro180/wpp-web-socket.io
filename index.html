<!doctype html>
<html>
  <head>
	<title>Conectar</title>
	<link rel="stylesheet" href="style.css">
  </head>
  <body>
	<div id="app">
		<div id="loading" >
			<img class="loaderAnimation" src="loader.svg">
		</div>

		<div class="isAuth" style="display: none;">
			<img src="check.svg">
			<p class="authTitle" >Você está autenticado!</p>
			<p>Em caso de erros, encerre a sessão e gere um novo QR Code</p>
			<button class="kill" onclick="kill();" >Encerrar</button>
		</div>
		<div class="code" >
			
		</div>

	</div>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/3.0.3/socket.io.js"></script>
	<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
	<script>
		var socket = io() // for latest version;

		socket.on("loading", () => {
			$('#loading').css("display", "inline");
		})
		
		socket.on("loadingFalse", () => {
			$('#loading').css("display", "none");
		})

		socket.on("paring", (base64Url) => {
			$('#loading').css("display", "none");
			$(".code").html(`<p>Escaneie o <strong>QR Code</strong> abaixo para sincronizar</p><img src="${base64Url}" alt="">`);
			$(".isAuth").css("display", "none");
		})

		socket.on("success", () => {
			$('#loading').css("display", "none");
			$(".isAuth").css("display", "inline");
			$(".code").html("");
		})

		socket.on("isAuthenticated", () => {
			$('#loading').css("display", "none");
			$(".isAuth").css("display", "inline");
			$(".code").html("");
		})

		function kill() {
			console.log('k')
			$(".isAuth").css("display", "none");
			$(".code").html("");
			socket.emit('closeConnection')	
		}

	</script>
</html>